<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SDVT Link Hub (CAPTCHA + Key)</title>
<style>
  :root{
    --bg:#071225; --card:#0b1620; --accent:#22d3aa; --muted:#94a3b8; --text:#e6eef6;
    --btn:#065f46; --btn-hover:#087a5f;
  }
  *{box-sizing:border-box;font-family:Inter,Segoe UI,system-ui,Arial,sans-serif}
  body{margin:0;background:linear-gradient(180deg,#02111a 0%, #081828 100%);color:var(--text);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px;}
  .wrap{width:100%;max-width:980px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));border-radius:12px;padding:20px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 6px 30px rgba(2,6,23,0.6)}
  header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
  header h1{margin:0;font-size:20px;letter-spacing:0.2px}
  .desc{color:var(--muted);font-size:13px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:12px}
  .card{background:var(--card);padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.02)}
  .item-header{display:flex;align-items:center;gap:12px}
  .logo{width:44px;height:44px;border-radius:8px;background:linear-gradient(135deg,#083344,#025b54);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:18px}
  .name{font-weight:600}
  .muted{color:var(--muted);font-size:13px}
  .controls{margin-top:12px;display:flex;align-items:center;gap:10px}
  button.cta{background:var(--btn);color:white;border:0;padding:10px 16px;border-radius:8px;cursor:pointer;font-weight:600}
  button.cta:hover{background:var(--btn-hover)}
  .counter{margin-left:auto;color:var(--muted);font-weight:700}
  .pill{margin-left:6px;background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:999px;color:var(--muted);font-weight:600}
  .progress{margin-top:14px;display:flex;gap:8px;align-items:center}
  .big{font-size:28px;font-weight:800;color:var(--accent)}
  .footer{margin-top:16px;display:flex;align-items:center;justify-content:space-between;gap:12px}
  .status{font-size:14px;color:var(--muted)}

  /* CAPTCHA modal */
  .captcha-modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.85);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    padding: 20px;
  }
  .captcha-box {
    background: var(--card);
    border-radius: 12px;
    padding: 24px;
    width: 100%;
    max-width: 400px;
    text-align: center;
    border: 1px solid rgba(255,255,255,0.05);
  }
  .captcha-box h3 {
    margin: 0 0 16px;
    font-size: 18px;
  }
  .captcha-prompt {
    font-size: 18px;
    font-weight: 700;
    margin: 12px 0;
    color: var(--accent);
  }
  .captcha-input {
    width: 100%;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid rgba(255,255,255,0.1);
    background: rgba(0,0,0,0.3);
    color: white;
    font-size: 16px;
    margin: 12px 0;
  }
  .captcha-error {
    color: #ff6b6b;
    font-size: 13px;
    min-height: 18px;
  }
  .btn-captcha {
    background: var(--btn);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
  }

  /* Key display */
  .key-display {
    margin-top: 20px;
    padding: 20px;
    background: rgba(0,0,0,0.3);
    border-radius: 10px;
    text-align: center;
    display: none;
  }
  .key-display h3 {
    margin: 0 0 12px;
    font-size: 18px;
  }
  .key-value {
    font-size: 22px;
    font-weight: 800;
    letter-spacing: 3px;
    color: var(--accent);
    margin: 10px 0;
    font-family: monospace;
  }
  .copy-btn {
    background: var(--accent);
    color: #012;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    font-weight: 700;
    cursor: pointer;
    margin-top: 8px;
  }
  .copy-btn:hover {
    opacity: 0.9;
  }

  /* overlay */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,0.7);display:none;align-items:center;justify-content:center;z-index:9000;padding:24px}
  .overlay .box{width:100%;max-width:1000px;height:80vh;background:#010712;border-radius:10px;overflow:hidden;display:flex;flex-direction:column;border:1px solid rgba(255,255,255,0.04)}
  .overlay .toolbar{display:flex;align-items:center;gap:12px;padding:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02))}
  .overlay .title{font-weight:700}
  .overlay .iframe-wrap{flex:1;background:#000;display:flex;align-items:center;justify-content:center}
  .overlay iframe{width:100%;height:100%;border:0}
  .overlay .controls{padding:10px;display:flex;gap:8px;justify-content:flex-end;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02))}
  .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);padding:8px 12px;border-radius:8px;cursor:pointer}
  .btn-primary{background:var(--accent);border:0;color:#012; padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700}
  .note{color:var(--muted);font-size:13px;padding:8px}
  @media(max-width:720px){
    .grid{grid-template-columns:1fr; }
    .overlay .box{height:90vh}
  }
</style>
</head>
<body>
  <!-- CAPTCHA MODAL (hi·ªán ƒë·∫ßu ti√™n) -->
  <div class="captcha-modal" id="initialCaptcha">
    <div class="captcha-box">
      <h3>üõ°Ô∏è X√°c minh b·∫°n kh√¥ng ph·∫£i robot</h3>
      <p>Vui l√≤ng gi·∫£i CAPTCHA ƒë·ªÉ ti·∫øp t·ª•c</p>
      <div class="captcha-prompt" id="initCaptchaPrompt">ƒêang t·∫°o...</div>
      <input type="text" class="captcha-input" id="initCaptchaInput" placeholder="Nh·∫≠p ƒë√°p √°n" autocomplete="off" />
      <div class="captcha-error" id="initCaptchaError"></div>
      <button class="btn-captcha" id="initCaptchaSubmit">X√°c minh</button>
    </div>
  </div>

  <div class="wrap" id="mainContent" style="display:none;" role="main" aria-labelledby="title">
    <header>
      <div style="width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,#0ea5a4,#065f46);display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:800">SD</div>
      <div>
        <h1 id="title">SDVT Link Hub</h1>
        <div class="desc">Ch·ªçn d·ªãch v·ª•, m·ªü overlay ƒë·ªÉ ho√†n t·∫•t nhi·ªám v·ª•. Linkvertise: 1x, Lootlabs: 2x.</div>
      </div>
    </header>

    <div class="grid">
      <div class="card" id="card-linkv">
        <div class="item-header">
          <div class="logo" aria-hidden="true">
            <svg width="30" height="30" viewBox="0 0 24 24" fill="none"><path d="M3 12c0 5 4 9 9 9s9-4 9-9-4-9-9-9S3 7 3 12z" fill="#00D1B2"/><path d="M7 12h10" stroke="#012" stroke-width="1.6" stroke-linecap="round"/></svg>
          </div>
          <div>
            <div class="name">Linkvertise</div>
            <div class="muted">Y√™u c·∫ßu: M·ªü link 1 l·∫ßn</div>
          </div>
          <div class="counter" id="cnt-linkv">0/1</div>
        </div>

        <div class="controls">
          <button class="cta" id="btn-linkv">B·∫Øt ƒë·∫ßu Linkvertise</button>
          <div class="pill" id="pill-linkv">Ch∆∞a</div>
        </div>
      </div>

      <div class="card" id="card-loot">
        <div class="item-header">
          <div class="logo" aria-hidden="true" style="background:linear-gradient(135deg,#fb923c,#ea580c)">
            <svg width="30" height="30" viewBox="0 0 24 24" fill="none"><rect x="2" y="2" width="20" height="20" rx="4" fill="transparent"/><path d="M7 12h10" stroke="#fff" stroke-width="1.6" stroke-linecap="round"/></svg>
          </div>
          <div>
            <div class="name">Lootlabs</div>
            <div class="muted">Y√™u c·∫ßu: M·ªü link 2 l·∫ßn</div>
          </div>
          <div class="counter" id="cnt-loot">0/2</div>
        </div>

        <div class="controls">
          <button class="cta" id="btn-loot">B·∫Øt ƒë·∫ßu Lootlabs</button>
          <div class="pill" id="pill-loot">Ch∆∞a</div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="status" id="status">Tr·∫°ng th√°i: 0/3</div>
      <div style="display:flex;gap:8px;align-items:center">
        <div class="pill">Linkv: <strong id="s-linkv">0</strong>/1</div>
        <div class="pill">Loot: <strong id="s-loot">0</strong>/2</div>
        <div class="pill big" id="overall">0/3</div>
      </div>
    </div>

    <!-- Key display (·∫©n m·∫∑c ƒë·ªãnh) -->
    <div class="key-display" id="keyDisplay">
      <h3>üîë Key c·ªßa b·∫°n</h3>
      <div class="key-value" id="keyValue">‚Äî</div>
      <button class="copy-btn" id="copyKeyBtn">Sao ch√©p Key</button>
    </div>
  </div>

  <!-- Overlay -->
  <div class="overlay" id="overlay">
    <div class="box" role="dialog" aria-modal="true">
      <div class="toolbar">
        <div class="title" id="ov-title">M·ªü link</div>
        <div style="flex:1"></div>
        <div class="note" id="ov-note">N·∫øu trang kh√¥ng hi·ªÉn th·ªã, d√πng "M·ªü b·∫£n ƒë·∫ßy ƒë·ªß".</div>
      </div>
      <div class="iframe-wrap" id="ov-frame-wrap"></div>
      <div class="controls">
        <button class="btn-ghost" id="ov-open">M·ªü b·∫£n ƒë·∫ßy ƒë·ªß</button>
        <button class="btn-primary" id="ov-done">T√¥i ƒë√£ ho√†n t·∫•t</button>
      </div>
    </div>
  </div>

  <div style="display:none" id="encoded" data-linkv="aHR0cHM6Ly9saW5rLWh1Yi5uZXQvMTI4MjM2OC9rb2s4QURkcFpOXzI=" data-loot="aHR0cHM6Ly9sb290ZGVzdC5vcmcvcw=="></div>

<script>
(function(){
  const required = { linkv: 1, loot: 2 };
  const counts = { linkv: 0, loot: 0 };
  let currentCaptchaAnswer = null;
  let userVerified = false;
  let currentTarget = null;

  // --- CAPTCHA ban ƒë·∫ßu ---
  function generateInitialCaptcha() {
    const a = Math.floor(Math.random() * 15) + 1;
    const b = Math.floor(Math.random() * 15) + 1;
    currentCaptchaAnswer = a + b;
    document.getElementById('initCaptchaPrompt').textContent = `${a} + ${b} = ?`;
  }

  document.getElementById('initCaptchaSubmit').addEventListener('click', verifyInitialCaptcha);
  document.getElementById('initCaptchaInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') verifyInitialCaptcha();
  });

  function verifyInitialCaptcha() {
    const input = document.getElementById('initCaptchaInput').value.trim();
    const errorEl = document.getElementById('initCaptchaError');
    if (input === currentCaptchaAnswer.toString()) {
      userVerified = true;
      document.getElementById('initialCaptcha').style.display = 'none';
      document.getElementById('mainContent').style.display = 'block';
      updateUI();
      // Kh√¥i ph·ª•c key n·∫øu c√≥
      checkAndDisplayExistingKey();
    } else {
      errorEl.textContent = 'Sai ƒë√°p √°n! H√£y th·ª≠ l·∫°i.';
    }
  }

  generateInitialCaptcha();

  // --- C√°c h√†m h·ªó tr·ª£ ---
  function b64decode(s){
    try {
      return decodeURIComponent(atob(s).split('').map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join(''));
    } catch(e){ return atob(s); }
  }

  const enc = document.getElementById('encoded');
  function getDecoded(name){
    return name === 'linkv' ? b64decode(enc.dataset.linkv) : b64decode(enc.dataset.loot);
  }

  // --- UI c·∫≠p nh·∫≠t ---
  function updateUI(){
    if (!userVerified) return;
    const cntLinkv = document.getElementById('cnt-linkv');
    const cntLoot = document.getElementById('cnt-loot');
    const pillLinkv = document.getElementById('pill-linkv');
    const pillLoot = document.getElementById('pill-loot');
    const sLinkv = document.getElementById('s-linkv');
    const sLoot = document.getElementById('s-loot');
    const status = document.getElementById('status');
    const overall = document.getElementById('overall');

    cntLinkv.textContent = counts.linkv + '/' + required.linkv;
    cntLoot.textContent = counts.loot + '/' + required.loot;
    sLinkv.textContent = counts.linkv;
    sLoot.textContent = counts.loot;
    const sum = counts.linkv + counts.loot;
    status.textContent = 'Tr·∫°ng th√°i: ' + sum + '/' + (required.linkv + required.loot);
    overall.textContent = sum + '/' + (required.linkv + required.loot);
    pillLinkv.textContent = counts.linkv >= required.linkv ? 'Ho√†n t·∫•t' : 'Ch∆∞a';
    pillLoot.textContent = counts.loot >= required.loot ? 'Ho√†n t·∫•t' : 'Ch∆∞a';

    // Ki·ªÉm tra ƒëi·ªÅu ki·ªán nh·∫≠n key
    if ((counts.linkv >= required.linkv) || (counts.loot >= required.loot)) {
      generateAndDisplayKey();
    }
  }

  // --- Key management ---
  function generateKey() {
    let key = '';
    for (let i = 0; i < 12; i++) {
      key += Math.floor(Math.random() * 10);
    }
    return key;
  }

  function generateAndDisplayKey() {
    let key = sessionStorage.getItem('user_key');
    const expire = sessionStorage.getItem('key_expire');
    const now = Date.now();

    if (!key || !expire || now >= parseInt(expire)) {
      key = generateKey();
      const newExpire = now + 12 * 60 * 60 * 1000; // 12 gi·ªù
      sessionStorage.setItem('user_key', key);
      sessionStorage.setItem('key_expire', newExpire.toString());
    }

    document.getElementById('keyValue').textContent = key;
    document.getElementById('keyDisplay').style.display = 'block';
  }

  function checkAndDisplayExistingKey() {
    const key = sessionStorage.getItem('user_key');
    const expire = sessionStorage.getItem('key_expire');
    if (key && expire && Date.now() < parseInt(expire)) {
      document.getElementById('keyValue').textContent = key;
      document.getElementById('keyDisplay').style.display = 'block';
    }
  }

  // --- Sao ch√©p key ---
  document.getElementById('copyKeyBtn').addEventListener('click', async () => {
    const key = document.getElementById('keyValue').textContent;
    if (key && key !== '‚Äî') {
      try {
        await navigator.clipboard.writeText(key);
        const btn = document.getElementById('copyKeyBtn');
        const original = btn.textContent;
        btn.textContent = 'ƒê√£ sao ch√©p!';
        setTimeout(() => btn.textContent = original, 1500);
      } catch (err) {
        console.error('Kh√¥ng th·ªÉ sao ch√©p:', err);
      }
    }
  });

  // --- Overlay logic ---
  function openOverlay(target){
    currentTarget = target;
    const url = getDecoded(target);
    document.getElementById('ov-title').textContent = target === 'linkv' ? 'Linkvertise' : 'Lootlabs';
    document.getElementById('ov-frame-wrap').innerHTML = `<iframe src="${url}" style="width:100%;height:100%;border:0"></iframe>`;
    document.getElementById('overlay').style.display = 'flex';
  }

  document.getElementById('ov-open').addEventListener('click', () => {
    if (currentTarget) window.open(getDecoded(currentTarget), '_blank');
  });

  document.getElementById('ov-done').addEventListener('click', () => {
    if (currentTarget === 'linkv') {
      counts.linkv = Math.min(required.linkv, counts.linkv + 1);
    } else if (currentTarget === 'loot') {
      counts.loot = Math.min(required.loot, counts.loot + 1);
    }
    updateUI();
    document.getElementById('overlay').style.display = 'none';
  });

  // --- N√∫t b·∫Øt ƒë·∫ßu ---
  document.getElementById('btn-linkv').addEventListener('click', () => {
    if (counts.linkv < required.linkv) openOverlay('linkv');
  });

  document.getElementById('btn-loot').addEventListener('click', () => {
    if (counts.loot < required.loot) openOverlay('loot');
  });
})();
</script>
</body>
</html>
